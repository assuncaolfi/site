{
  "hash": "110aaa98da759f35b593fb2cb19513e5",
  "result": {
    "markdown": "---\ntitle: Picking a fantasy football team\ndate: 2023-09-21\ncategories: [football, optimization, prediction]\n---\n\n[Cartola](http://cartola.globo.com) is a fantasy football league following the\nBrazilian Championship A Series.\n\nCartola offers a public API to access data for the current round. A couple\nof years ago, I created a script to automate data retrieval to a \n[repository](https://github.com/assuncaolfi/tophat/tree/main), which now hosts\ncomprehensive historical data since 2022.\n\nIn this post, we will delve into the data for the 2022 season, formulate a mixed\ninteger linear program to pick the optimal team, and present initial concepts\nfor forecasting player scores using mixed effects linear models.\n\n## The game \n\nWe begin the season with a budget of C$ 100, the game’s paper currency.\n\nEach round is preceded by a market session, where players are assigned a value.\nWe are tasked with forming a team of 11 players plus a coach, all within our\nbudget and adhering to a valid formation. A captain must be chosen from among\nthe players, excluding the coach.\n\nThe market is available until the round starts. Players then earn scores based\non their real-life match performances. Our team's score is the aggregate of\nour players' scores, with our captain’s score doubled in the 2022 season.\n\nFollowing the conclusion of the round, player values are recalibrated based\non performance -— with increases for scores above their average and decreases for\nbelow-average performances. Our budget for the next round is our previous\nbudget, plus the sum of our players' value variations.\n\n## Data wrangling\n\nLet's talk about data structures: each round has a market, and each market is a\nlist of players. A player is a structure like this:\n\n::: {#cell-data-wrangling-players .cell execution_count=2}\n\n::: {#data-wrangling-players .cell-output .cell-output-display}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"color: #800080; text-decoration-color: #800080; font-weight: bold\">Player</span><span style=\"font-weight: bold\">(</span>\n<span style=\"color: #7fbf7f; text-decoration-color: #7fbf7f\">│   </span><span style=\"color: #808000; text-decoration-color: #808000\">round</span>=<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0</span>,\n<span style=\"color: #7fbf7f; text-decoration-color: #7fbf7f\">│   </span><span style=\"color: #808000; text-decoration-color: #808000\">player</span>=<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">42234</span>,\n<span style=\"color: #7fbf7f; text-decoration-color: #7fbf7f\">│   </span><span style=\"color: #808000; text-decoration-color: #808000\">team</span>=<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">264</span>,\n<span style=\"color: #7fbf7f; text-decoration-color: #7fbf7f\">│   </span><span style=\"color: #808000; text-decoration-color: #808000\">position</span>=<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span>,\n<span style=\"color: #7fbf7f; text-decoration-color: #7fbf7f\">│   </span><span style=\"color: #808000; text-decoration-color: #808000\">games</span>=<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0</span>,\n<span style=\"color: #7fbf7f; text-decoration-color: #7fbf7f\">│   </span><span style=\"color: #808000; text-decoration-color: #808000\">average</span>=<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.0</span>,\n<span style=\"color: #7fbf7f; text-decoration-color: #7fbf7f\">│   </span><span style=\"color: #808000; text-decoration-color: #808000\">value</span>=<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">10.0</span>,\n<span style=\"color: #7fbf7f; text-decoration-color: #7fbf7f\">│   </span><span style=\"color: #808000; text-decoration-color: #808000\">score</span>=<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.0</span>,\n<span style=\"color: #7fbf7f; text-decoration-color: #7fbf7f\">│   </span><span style=\"color: #808000; text-decoration-color: #808000\">appreciation</span>=<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.0</span>,\n<span style=\"color: #7fbf7f; text-decoration-color: #7fbf7f\">│   </span><span style=\"color: #808000; text-decoration-color: #808000\">minimum</span>=<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4.53</span>\n<span style=\"font-weight: bold\">)</span>\n</pre>\n```\n:::\n:::\n\n\nLet's get the list of markets for 2022 and flatten it into a single DataFrame:\n\n::: {#cell-data-wrangling-dataframe .cell execution_count=3}\n\n::: {#data-wrangling-dataframe .cell-output .cell-output-display}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">shape: <span style=\"font-weight: bold\">(</span>30_063, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">10</span><span style=\"font-weight: bold\">)</span>\n┌───────┬────────┬──────┬──────────┬───┬───────┬───────┬──────────────┬─────────┐\n│ round ┆ player ┆ team ┆ position ┆ … ┆ value ┆ score ┆ appreciation ┆ minimum │\n╞═══════╪════════╪══════╪══════════╪═══╪═══════╪═══════╪══════════════╪═════════╡\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span>     ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">37424</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1371</span> ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">6</span>        ┆ … ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3.0</span>   ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.0</span>   ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.0</span>          ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.0</span>     │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span>     ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">37646</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">314</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3</span>        ┆ … ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5.0</span>   ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.0</span>   ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.0</span>          ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2.3</span>     │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span>     ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">37656</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">266</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span>        ┆ … ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">9.0</span>   ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.0</span>   ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.0</span>          ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4.08</span>    │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span>     ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">37788</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">356</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span>        ┆ … ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4.0</span>   ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.0</span>   ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.0</span>          ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1.85</span>    │\n│ …     ┆ …      ┆ …    ┆ …        ┆ … ┆ …     ┆ …     ┆ …            ┆ …       │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">38</span>    ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">121397</span> ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">286</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2</span>        ┆ … ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1.0</span>   ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.0</span>   ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.0</span>          ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.0</span>     │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">38</span>    ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">121398</span> ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">354</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4</span>        ┆ … ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1.0</span>   ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.0</span>   ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.0</span>          ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.0</span>     │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">38</span>    ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">121399</span> ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">354</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4</span>        ┆ … ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1.0</span>   ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.0</span>   ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.0</span>          ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.0</span>     │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">38</span>    ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">121400</span> ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">354</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5</span>        ┆ … ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1.0</span>   ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.0</span>   ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.0</span>          ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.0</span>     │\n└───────┴────────┴──────┴──────────┴───┴───────┴───────┴──────────────┴─────────┘\n</pre>\n```\n:::\n:::\n\n\nNow, let's focus on a specific `player` to illustrate our data while we wrangle\nit:\n\n::: {#cell-data-wrangling-example .cell execution_count=4}\n\n::: {#data-wrangling-example .cell-output .cell-output-display}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">shape: <span style=\"font-weight: bold\">(</span><span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">38</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">10</span><span style=\"font-weight: bold\">)</span>\n┌───────┬────────┬──────┬──────────┬───┬───────┬───────┬──────────────┬─────────┐\n│ round ┆ player ┆ team ┆ position ┆ … ┆ value ┆ score ┆ appreciation ┆ minimum │\n╞═══════╪════════╪══════╪══════════╪═══╪═══════╪═══════╪══════════════╪═════════╡\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span>     ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">42234</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">264</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span>        ┆ … ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">10.0</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.0</span>   ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.0</span>          ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4.53</span>    │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2</span>     ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">42234</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">264</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span>        ┆ … ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">7.93</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2.0</span>   ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-2.07</span>        ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5.52</span>    │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3</span>     ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">42234</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">264</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span>        ┆ … ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">10.44</span> ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">11.0</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2.51</span>         ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4.75</span>    │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4</span>     ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">42234</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">264</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span>        ┆ … ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">10.44</span> ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.0</span>   ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.0</span>          ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5.78</span>    │\n│ …     ┆ …      ┆ …    ┆ …        ┆ … ┆ …     ┆ …     ┆ …            ┆ …       │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">35</span>    ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">42234</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">264</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span>        ┆ … ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">11.48</span> ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.0</span>   ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-0.71</span>        ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3.55</span>    │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">36</span>    ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">42234</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">264</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span>        ┆ … ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">11.51</span> ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.0</span>   ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.03</span>         ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3.63</span>    │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">37</span>    ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">42234</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">264</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span>        ┆ … ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">12.68</span> ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.0</span>   ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1.17</span>         ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">9.29</span>    │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">38</span>    ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">42234</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">264</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span>        ┆ … ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">11.06</span> ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.0</span>   ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-1.62</span>        ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1.37</span>    │\n└───────┴────────┴──────┴──────────┴───┴───────┴───────┴──────────────┴─────────┘\n</pre>\n```\n:::\n:::\n\n\n### Filtering participation\n\nPlayers will show up in the market for many rounds that they do not participate\nin. However, for our analysis, we are only interested in players that actually\nplayed a game in the round.\n\nEach player has a `status` field intended to indicate their participation in the\nround. However, this field is often inaccurate, likely due to the API data being\nupdated before the round.\n\nOne solution is to keep only rows where there is an increase in the number of\n`games` the player has played:\n\n::: {#cell-data-wrangling-round-participation .cell execution_count=5}\n\n::: {#data-wrangling-round-participation .cell-output .cell-output-display}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">shape: <span style=\"font-weight: bold\">(</span><span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">31</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3</span><span style=\"font-weight: bold\">)</span>\n┌───────┬────────┬───────┐\n│ round ┆ player ┆ games │\n╞═══════╪════════╪═══════╡\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span>     ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">42234</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0</span>     │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2</span>     ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">42234</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span>     │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3</span>     ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">42234</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2</span>     │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5</span>     ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">42234</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3</span>     │\n│ …     ┆ …      ┆ …     │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">35</span>    ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">42234</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">27</span>    │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">36</span>    ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">42234</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">28</span>    │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">37</span>    ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">42234</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">29</span>    │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">38</span>    ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">42234</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">30</span>    │\n└───────┴────────┴───────┘\n</pre>\n```\n:::\n:::\n\n\n### Imputing scores\n\nSimilarly, the player `score` field is often inaccurate, likely for the same\nreasons as the `status` field. Fortunately, the `average` field is reliable,\nallowing us to recover the `score`:\n\n$$\n\\begin{align*}\n\\mathrm{Average}(\\mathbf{s}_{1:t})\n= \\frac{\\mathrm{Average}(\\mathbf{s}_{1:(t-1)}) + s_t}{2} \\\\\ns_t \n= 2\\mathrm{Average}(\\mathbf{s}_{1:t}) - \\mathrm{Average}(\\mathbf{s}_{1:(t-1)}),\n\\end{align*}\n$$\n\nwhere $\\mathbf{s}$ is the vector of scores for a given player across all rounds.\n\n::: {#cell-data-wrangling-missing-scores .cell execution_count=6}\n\n::: {#data-wrangling-missing-scores .cell-output .cell-output-display}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">shape: <span style=\"font-weight: bold\">(</span><span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">31</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4</span><span style=\"font-weight: bold\">)</span>\n┌───────┬────────┬───────┬─────────┐\n│ round ┆ player ┆ score ┆ average │\n╞═══════╪════════╪═══════╪═════════╡\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span>     ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">42234</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2.0</span>   ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2.0</span>     │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2</span>     ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">42234</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">11.0</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">6.5</span>     │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3</span>     ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">42234</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">9.5</span>   ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">8.0</span>     │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5</span>     ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">42234</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">8.6</span>   ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">8.3</span>     │\n│ …     ┆ …      ┆ …     ┆ …       │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">35</span>    ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">42234</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4.73</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4.82</span>    │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">36</span>    ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">42234</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5.1</span>   ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4.96</span>    │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">37</span>    ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">42234</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4.62</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4.79</span>    │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">38</span>    ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">42234</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4.79</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4.79</span>    │\n└───────┴────────┴───────┴─────────┘\n</pre>\n```\n:::\n:::\n\n\n### Adding fixtures\n\nLet's fetch the list of fixtures to enrich our dataset. A fixture is an object\nlike:\n\n::: {#cell-data-wrangling-fixtures .cell execution_count=7}\n\n::: {#data-wrangling-fixtures .cell-output .cell-output-display}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"color: #800080; text-decoration-color: #800080; font-weight: bold\">Fixture</span><span style=\"font-weight: bold\">(</span><span style=\"color: #808000; text-decoration-color: #808000\">round</span>=<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span>, <span style=\"color: #808000; text-decoration-color: #808000\">home</span>=<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">282</span>, <span style=\"color: #808000; text-decoration-color: #808000\">away</span>=<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">285</span><span style=\"font-weight: bold\">)</span>\n</pre>\n```\n:::\n:::\n\n\nLet's consolidate these fixtures into a single DataFrame and then pivot them\ninto a long format:\n\n::: {#cell-data-wrangling-fixtures-long .cell execution_count=8}\n\n::: {#data-wrangling-fixtures-long .cell-output .cell-output-display}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">shape: <span style=\"font-weight: bold\">(</span><span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">760</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4</span><span style=\"font-weight: bold\">)</span>\n┌───────┬──────┬────────┬──────┐\n│ round ┆ team ┆ versus ┆ home │\n╞═══════╪══════╪════════╪══════╡\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span>     ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">282</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">285</span>    ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span>    │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span>     ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">266</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">277</span>    ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span>    │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span>     ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">276</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">293</span>    ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span>    │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span>     ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">373</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">262</span>    ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span>    │\n│ …     ┆ …    ┆ …      ┆ …    │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">38</span>    ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">286</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">354</span>    ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0</span>    │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">38</span>    ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">276</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">290</span>    ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0</span>    │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">38</span>    ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">294</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1371</span>   ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0</span>    │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">38</span>    ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">263</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">293</span>    ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0</span>    │\n└───────┴──────┴────────┴──────┘\n</pre>\n```\n:::\n:::\n\n\nFinally, let's join this data to our dataset:\n\n::: {#cell-data-wrangling-fixtures-join .cell execution_count=9}\n\n::: {#data-wrangling-fixtures-join .cell-output .cell-output-display}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">shape: <span style=\"font-weight: bold\">(</span><span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">31</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5</span><span style=\"font-weight: bold\">)</span>\n┌───────┬────────┬──────┬────────┬──────┐\n│ round ┆ player ┆ team ┆ versus ┆ home │\n╞═══════╪════════╪══════╪════════╪══════╡\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span>     ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">42234</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">264</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">263</span>    ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0</span>    │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2</span>     ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">42234</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">264</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">314</span>    ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span>    │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3</span>     ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">42234</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">264</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">275</span>    ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0</span>    │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5</span>     ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">42234</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">264</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">280</span>    ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0</span>    │\n│ …     ┆ …      ┆ …    ┆ …      ┆ …    │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">35</span>    ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">42234</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">264</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">262</span>    ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0</span>    │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">36</span>    ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">42234</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">264</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">354</span>    ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span>    │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">37</span>    ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">42234</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">264</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">294</span>    ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0</span>    │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">38</span>    ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">42234</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">264</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">282</span>    ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span>    │\n└───────┴────────┴──────┴────────┴──────┘\n</pre>\n```\n:::\n:::\n\n\n### Aligning variables\n\nIn our subsequent analysis, the `average` field will exclude the `score` from\nthe given round. Additionally, the `appreciation` field will be calculated in\nrelation to the round's `score`.\n\n::: {#cell-data-wrangling-lookahead-variables .cell execution_count=10}\n\n::: {#data-wrangling-lookahead-variables .cell-output .cell-output-display}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">shape: <span style=\"font-weight: bold\">(</span><span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">31</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">6</span><span style=\"font-weight: bold\">)</span>\n┌───────┬────────┬─────────┬───────┬───────┬──────────────┐\n│ round ┆ player ┆ average ┆ value ┆ score ┆ appreciation │\n╞═══════╪════════╪═════════╪═══════╪═══════╪══════════════╡\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span>     ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">42234</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.0</span>     ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">10.0</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2.0</span>   ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-2.07</span>        │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2</span>     ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">42234</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2.0</span>     ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">7.93</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">11.0</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2.51</span>         │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3</span>     ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">42234</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">6.5</span>     ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">10.44</span> ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">9.5</span>   ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1.25</span>         │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5</span>     ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">42234</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">8.0</span>     ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">11.69</span> ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">8.6</span>   ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.73</span>         │\n│ …     ┆ …      ┆ …       ┆ …     ┆ …     ┆ …            │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">35</span>    ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">42234</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4.91</span>    ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">11.48</span> ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4.73</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.03</span>         │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">36</span>    ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">42234</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4.82</span>    ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">11.51</span> ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5.1</span>   ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1.17</span>         │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">37</span>    ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">42234</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4.96</span>    ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">12.68</span> ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4.62</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">-1.62</span>        │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">38</span>    ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">42234</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4.79</span>    ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">11.06</span> ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4.79</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.0</span>          │\n└───────┴────────┴─────────┴───────┴───────┴──────────────┘\n</pre>\n```\n:::\n:::\n\n\n## Team picking\n\nNow let's solve the problem of picking the best team a given market. Let $\n\\mathcal{F}$ be the set of valid formations, then for each formation $f \\in\n\\mathcal{F}$, solve:\n\n$$\n\\begin{equation*} \\begin{array}{ll@{}ll} \n\\text{maximize} & \\displaystyle \\hat{\\mathbf{s}}^T \\mathbf{x}, & \\mathbf{x} \\in \\{\\mathbf{0}, \\mathbf{1}\\} \\\\ \n\\text{subject to} \n& \\displaystyle \\mathbf{v}^T \\mathbf{x} \\leq b \\\\ \n& \\displaystyle \\mathbf{P}^T \\mathbf{x} = f, \\\\ \n\\end{array} \\end{equation*}\n$$\n\nwhere\n\n$\\mathbf{x}$ is a variable vector of player picks in the market;  \n$\\hat{\\mathbf{s}}$ is the vector of predicted player scores in the market;  \n$b$ is our available budget for that round;  \n$\\mathbf{P}$ is the matrix of dummy-encoded player formations in the market.\n\nFinally, take the solution with the highest objective.\n\n\n\n::: {#team-picking-problem .cell execution_count=12}\n``` {.python .cell-code}\nclass Problem(BaseModel):\n    scores: List[float]\n    values: List[float]\n    budget: float\n    positions: List[List[int]]\n    formations: List[Formation]\n\n    def solve(self) -> List[pulp.LpSolution]:\n        formations = [list(f.model_dump().values()) for f in self.formations]\n        problems = [self.construct(f) for f in formations]\n        [p.solve(pulp.COIN(msg=False)) for p in problems]\n        objectives = [p.objective.value() for p in problems]\n        best = np.argmax(np.array(objectives))\n        solution = problems[best]\n        variables = [v.value() for v in solution.variables()]\n        picks = np.array(variables)\n        return picks\n\n    def construct(self, formation: List[int]) -> pulp.LpProblem:\n        n = len(self.scores)\n        m = len(formation)\n        problem = pulp.LpProblem(\"team_picking\", pulp.LpMaximize)\n        indexes = [\"pick_\" + str(i).zfill(len(str(n))) for i in range(n)]\n        picks = [pulp.LpVariable(i, cat=pulp.const.LpBinary) for i in indexes]\n        problem += pulp.lpDot(picks, self.scores)\n        problem += pulp.lpDot(picks, self.values) <= self.budget\n        for i in range(m):\n            problem += pulp.lpDot(picks, self.positions[i]) == formation[i]\n        return problem\n```\n:::\n\n\n### Backtesting\n\nBy solving the team picking problem for all rounds, we can backtest our\nperformance in the season. Before backtesting, let's get the set of valid\nformations  $\\mathcal{F}$:\n\n::: {#cell-team-picking-formations .cell execution_count=13}\n\n::: {#team-picking-formations .cell-output .cell-output-display}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"font-weight: bold\">[</span>\n<span style=\"color: #7fbf7f; text-decoration-color: #7fbf7f\">│   </span><span style=\"color: #800080; text-decoration-color: #800080; font-weight: bold\">Formation</span><span style=\"font-weight: bold\">(</span><span style=\"color: #808000; text-decoration-color: #808000\">goalkeeper</span>=<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span>, <span style=\"color: #808000; text-decoration-color: #808000\">defender</span>=<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3</span>, <span style=\"color: #808000; text-decoration-color: #808000\">winger</span>=<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0</span>, <span style=\"color: #808000; text-decoration-color: #808000\">midfielder</span>=<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4</span>, <span style=\"color: #808000; text-decoration-color: #808000\">forward</span>=<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3</span>, <span style=\"color: #808000; text-decoration-color: #808000\">coach</span>=<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span><span style=\"font-weight: bold\">)</span>,\n<span style=\"color: #7fbf7f; text-decoration-color: #7fbf7f\">│   </span><span style=\"color: #800080; text-decoration-color: #800080; font-weight: bold\">Formation</span><span style=\"font-weight: bold\">(</span><span style=\"color: #808000; text-decoration-color: #808000\">goalkeeper</span>=<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span>, <span style=\"color: #808000; text-decoration-color: #808000\">defender</span>=<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3</span>, <span style=\"color: #808000; text-decoration-color: #808000\">winger</span>=<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0</span>, <span style=\"color: #808000; text-decoration-color: #808000\">midfielder</span>=<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5</span>, <span style=\"color: #808000; text-decoration-color: #808000\">forward</span>=<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2</span>, <span style=\"color: #808000; text-decoration-color: #808000\">coach</span>=<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span><span style=\"font-weight: bold\">)</span>,\n<span style=\"color: #7fbf7f; text-decoration-color: #7fbf7f\">│   </span><span style=\"color: #800080; text-decoration-color: #800080; font-weight: bold\">Formation</span><span style=\"font-weight: bold\">(</span><span style=\"color: #808000; text-decoration-color: #808000\">goalkeeper</span>=<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span>, <span style=\"color: #808000; text-decoration-color: #808000\">defender</span>=<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2</span>, <span style=\"color: #808000; text-decoration-color: #808000\">winger</span>=<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2</span>, <span style=\"color: #808000; text-decoration-color: #808000\">midfielder</span>=<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3</span>, <span style=\"color: #808000; text-decoration-color: #808000\">forward</span>=<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3</span>, <span style=\"color: #808000; text-decoration-color: #808000\">coach</span>=<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span><span style=\"font-weight: bold\">)</span>,\n<span style=\"color: #7fbf7f; text-decoration-color: #7fbf7f\">│   </span><span style=\"color: #800080; text-decoration-color: #800080; font-weight: bold\">Formation</span><span style=\"font-weight: bold\">(</span><span style=\"color: #808000; text-decoration-color: #808000\">goalkeeper</span>=<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span>, <span style=\"color: #808000; text-decoration-color: #808000\">defender</span>=<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2</span>, <span style=\"color: #808000; text-decoration-color: #808000\">winger</span>=<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2</span>, <span style=\"color: #808000; text-decoration-color: #808000\">midfielder</span>=<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4</span>, <span style=\"color: #808000; text-decoration-color: #808000\">forward</span>=<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2</span>, <span style=\"color: #808000; text-decoration-color: #808000\">coach</span>=<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span><span style=\"font-weight: bold\">)</span>,\n<span style=\"color: #7fbf7f; text-decoration-color: #7fbf7f\">│   </span><span style=\"color: #800080; text-decoration-color: #800080; font-weight: bold\">Formation</span><span style=\"font-weight: bold\">(</span><span style=\"color: #808000; text-decoration-color: #808000\">goalkeeper</span>=<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span>, <span style=\"color: #808000; text-decoration-color: #808000\">defender</span>=<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2</span>, <span style=\"color: #808000; text-decoration-color: #808000\">winger</span>=<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2</span>, <span style=\"color: #808000; text-decoration-color: #808000\">midfielder</span>=<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5</span>, <span style=\"color: #808000; text-decoration-color: #808000\">forward</span>=<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span>, <span style=\"color: #808000; text-decoration-color: #808000\">coach</span>=<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span><span style=\"font-weight: bold\">)</span>,\n<span style=\"color: #7fbf7f; text-decoration-color: #7fbf7f\">│   </span><span style=\"color: #800080; text-decoration-color: #800080; font-weight: bold\">Formation</span><span style=\"font-weight: bold\">(</span><span style=\"color: #808000; text-decoration-color: #808000\">goalkeeper</span>=<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span>, <span style=\"color: #808000; text-decoration-color: #808000\">defender</span>=<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3</span>, <span style=\"color: #808000; text-decoration-color: #808000\">winger</span>=<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2</span>, <span style=\"color: #808000; text-decoration-color: #808000\">midfielder</span>=<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3</span>, <span style=\"color: #808000; text-decoration-color: #808000\">forward</span>=<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2</span>, <span style=\"color: #808000; text-decoration-color: #808000\">coach</span>=<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span><span style=\"font-weight: bold\">)</span>,\n<span style=\"color: #7fbf7f; text-decoration-color: #7fbf7f\">│   </span><span style=\"color: #800080; text-decoration-color: #800080; font-weight: bold\">Formation</span><span style=\"font-weight: bold\">(</span><span style=\"color: #808000; text-decoration-color: #808000\">goalkeeper</span>=<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span>, <span style=\"color: #808000; text-decoration-color: #808000\">defender</span>=<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3</span>, <span style=\"color: #808000; text-decoration-color: #808000\">winger</span>=<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2</span>, <span style=\"color: #808000; text-decoration-color: #808000\">midfielder</span>=<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">4</span>, <span style=\"color: #808000; text-decoration-color: #808000\">forward</span>=<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span>, <span style=\"color: #808000; text-decoration-color: #808000\">coach</span>=<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span><span style=\"font-weight: bold\">)</span>\n<span style=\"font-weight: bold\">]</span>\n</pre>\n```\n:::\n:::\n\n\nKnowing our formation constraints, we're ready to backtest. Starting with a\nbudget of C$ 100, for each round let's:\n\n1. Predict each player's score based on their performance on previous rounds;\n2. Pick the team with the best total score;\n3. Add the sum of the team player's appreciation to our budget.\n\n\n\n::: {#team-picking-backtest .cell execution_count=15}\n``` {.python .cell-code}\ndef backtest(\n    players: pl.DataFrame, predict: Callable, initial_budget: float = 100.0\n) -> pl.DataFrame:\n    rounds = players.get_column(\"round\").max()\n    budget = [None] * rounds\n    teams = [None] * rounds\n    budget[0] = initial_budget\n    for round in range(rounds):\n        if round > 0:\n            budget[round] = budget[round - 1] + appreciation\n        data = players.filter(pl.col(\"round\") < round + 1)\n        candidates = players.filter(pl.col(\"round\") == round + 1)\n        candidates = predict(data, candidates)\n        problem = Problem(\n            scores=candidates.get_column(\"prediction\"),\n            values=candidates.get_column(\"value\"),\n            positions=candidates.get_column(\"position\").to_dummies(),\n            budget=budget[round],\n            formations=formations,\n        )\n        picks = problem.solve()\n        team = candidates.filter(picks == 1)\n        teams[round] = team\n        appreciation = team.get_column(\"appreciation\").sum()\n    teams = pl.concat(teams)\n    return teams\n```\n:::\n\n\nBefore exploring predictions, we'll begin with a few hypothetical backtests\nusing actual observed scores for team selection. Backtesting this strategy, this\nis our team in the first round:\n\n::: {#cell-team-picking-backtest-first-team .cell execution_count=16}\n\n::: {#team-picking-backtest-first-team .cell-output .cell-output-display}\n```{=html}\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">shape: <span style=\"font-weight: bold\">(</span><span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">12</span>, <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">13</span><span style=\"font-weight: bold\">)</span>\n┌───────┬────────┬──────┬──────────┬───┬─────────┬────────┬──────┬────────────┐\n│ round ┆ player ┆ team ┆ position ┆ … ┆ minimum ┆ versus ┆ home ┆ prediction │\n╞═══════╪════════╪══════╪══════════╪═══╪═════════╪════════╪══════╪════════════╡\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span>     ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">71571</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">356</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span>        ┆ … ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3.19</span>    ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1371</span>   ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span>    ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">11.0</span>       │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span>     ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">42145</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">294</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2</span>        ┆ … ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2.75</span>    ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">290</span>    ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span>    ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">15.8</span>       │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span>     ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">105584</span> ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">264</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2</span>        ┆ … ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2.75</span>    ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">263</span>    ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0</span>    ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">10.5</span>       │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span>     ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">107110</span> ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">280</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">3</span>        ┆ … ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2.3</span>     ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">286</span>    ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0</span>    ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">14.9</span>       │\n│ …     ┆ …      ┆ …    ┆ …        ┆ … ┆ …       ┆ …      ┆ …    ┆ …          │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span>     ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">39148</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">282</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5</span>        ┆ … ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">7.2</span>     ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">285</span>    ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span>    ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">18.9</span>       │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span>     ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">89840</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">276</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5</span>        ┆ … ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5.42</span>    ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">293</span>    ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span>    ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">27.1</span>       │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span>     ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">104530</span> ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">294</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5</span>        ┆ … ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">2.3</span>     ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">290</span>    ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span>    ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">11.0</span>       │\n│ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span>     ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">97341</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">276</span>  ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">6</span>        ┆ … ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.0</span>     ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">293</span>    ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">1</span>    ┆ <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">9.52</span>       │\n└───────┴────────┴──────┴──────────┴───┴─────────┴────────┴──────┴────────────┘\n</pre>\n```\n:::\n:::\n\n\nAnd we can plot out cumulative performance during the season:\n\n::: {#cell-team-picking-backtest-score .cell execution_count=17}\n\n::: {.cell-output .cell-output-display execution_count=16}\n![](index_files/figure-html/team-picking-backtest-score-output-1.png){#team-picking-backtest-score width=604 height=445}\n:::\n:::\n\n\nThis might seem like a perfect campaign at first, but it's possible that, early\nin the season, we didn't have enough budget to pick the best scoring teams. To\ntest this hypothesis, we backtest the same strategy with unlimited budget from\nthe start:\n\n::: {#cell-team-picking-backtest-score-unlimited-budget .cell execution_count=18}\n\n::: {.cell-output .cell-output-display execution_count=17}\n![](index_files/figure-html/team-picking-backtest-score-unlimited-budget-output-1.png){#team-picking-backtest-score-unlimited-budget width=613 height=445}\n:::\n:::\n\n\nBoth runs are nearly identical, which is evidence that focusing on appreciation\nis not so important if we have accurate predictions for the scores. If we\npredict scores perfectly, we get a near perfect run.\n\nTo put our backtests into perspective, \n[the 2022 season champion had a total score of 3434.37](https://ge.globo.com/cartola/noticia/2022/12/03/cartola-2022-com-larga-vantagem-mosquito-bar-8-vence-liga-premiada-meliuz-e-fatura-r-20-mil.ghtml).\nThis is very impressive and not very far from the near perfect run.\n\n::: {#cell-team-picking-backtest-champion .cell execution_count=19}\n\n::: {.cell-output .cell-output-display execution_count=18}\n![](index_files/figure-html/team-picking-backtest-champion-output-1.png){#team-picking-backtest-champion width=605 height=445}\n:::\n:::\n\n\n## Score prediction\n\nFor each round, we must predict $\\hat{s}$, the vector of score predictions,\nusing data from previous rounds.\n\nHowever, during the first round, we don't have any previous data to train our\nmodel. In this case, we need to include prior information. One way to do that\nwould be to use data from previous seasons. However, we know a variable where\nthis information is already encoded: the player `value`. Each season starts with\nplayers valued according to their past performance. Knowing this, all our models\nstart with $\\hat{s} = v$ in the first round.\n\nLet's use Bambi [@Capretto2022] and its default priors to fit our models. We\nwon't  delve into convergence diagnostics, since we are more interested in the\naverage of the predictive posteriors and the backtest itself is measure of the\nprediction quality.\n\nOne question that arises here is: why not use non-parametric models such\nas gradient boosted trees or neural nets? After some experimentation, I\nconcluded they are not a good fit for this problem: either because they\nassume independence between observations, or because they are too data hungry.\nAlso, tuning these models for backtests might lead us into a rabbit hole\n[@Bailey2013].\n\n### Player average\n\n$$\n\\begin{align*}\n\\mathbf{\\hat{s}} = \\mathbf{Z} \\mathbf{\\beta} \\\\\n\\mathbf{s} \\sim N(\\mathbf{\\hat{s}}, \\sigma),\n\\end{align*}\n$$\n\nwhere  \n$\\mathbf{Z}$ is a dummy-encoded matrix of players;  \n$\\mathbf{\\beta}$ is a vector of parameters for each player.\n\nIn this model, $\\mathbf{\\beta}$ is simply a vector of player averages. Let's\nalso consider that players that show up in the middle of the season have an\naverage of zero before their first round. This will be our baseline model.\n\n::: {#cell-score-prediction-player-average .cell execution_count=20}\n\n::: {.cell-output .cell-output-display execution_count=19}\n![](index_files/figure-html/score-prediction-player-average-output-1.png){#score-prediction-player-average width=608 height=445}\n:::\n:::\n\n\n### Player random effects\n\n$$\n\\begin{align*}\n\\mathbf{\\hat{s}} = \\alpha + \\mathbf{Z} \\mathbf{b} \\\\\n\\mathbf{b} \\sim N(0, \\sigma_b),\n\\end{align*}\n$$\n\nwhere  \n$\\alpha$ is an intercept and  \n$\\mathbf{b}$ is a vector of player random effects.\n\nThis model performs significantly better than the average model, possibly\nbecause of the partial pooling between the random effects, that pulls large\neffects towards the overall mean [@clark2019shrinkage]. In our dataset, it's\ncommon for players that played one or two games to have large averages by\nchance.\n\n::: {#cell-score-prediction-player-random-effects .cell execution_count=21}\n\n::: {.cell-output .cell-output-display execution_count=20}\n![](index_files/figure-html/score-prediction-player-random-effects-output-1.png){#score-prediction-player-random-effects width=608 height=445}\n:::\n:::\n\n\n### Fixture mixed effects\n\n$$\n\\mathbf{\\hat{s}} = \\alpha + \\mathbf{X} \\mathbf{\\beta} + \\mathbf{Z} \\mathbf{b},\n$$\n\nwhere  \n$\\mathbf{X}$ is a matrix of the dummy-encoded fixture variables: the player\n    `team`, whether they are playing at `home`, and their `adversary` team\n    variables;\n$\\mathbf{\\beta}$ is a vector of fixed effects.\n\nThis model brings more context to our predictions. It also provides a reasonable\nway to predict a new player, by setting their $b = 0$ (the mean of the random\neffects). However, it does not improve significantly over our random effects\nmodel.\n\n::: {#cell-score-prediction-fixture-mixed-effects .cell execution_count=22}\n\n::: {.cell-output .cell-output-display execution_count=21}\n![](index_files/figure-html/score-prediction-fixture-mixed-effects-output-1.png){#score-prediction-fixture-mixed-effects width=608 height=445}\n:::\n:::\n\n\n## Conclusion\n\nWe developed a comprehensive framework for the fantasy football team picking\nproblem. There are more ideas we could explore to improve our chances of\nwinning:\n\n* enriching our data and models with player scouts;\n* including more information in our priors;\n* testing strategies that balance predicted score and appreciation;\n* further model diagnostics.\n\nHowever, I suppose expert human player predictions have a certain edge over\nthose of hobbyist statistical models in fantasy leagues, due to the fact that\nthere are all sorts of relevant data unavailable in public datasets.\n\nAt least, this seems to be the case for brazilian soccer, also known as \"a\nlittle box of surprises\".\n\n",
    "supporting": [
      "index_files/figure-html"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}
